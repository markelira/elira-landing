/**
 * Create modules and lessons for production course
 */

const admin = require('firebase-admin');
const path = require('path');

const serviceAccountPath = path.resolve(__dirname, '../elira-landing-ce927-firebase-adminsdk-fbsvc-9e1935180c.json');

if (!admin.apps.length) {
  admin.initializeApp({
    credential: admin.credential.cert(serviceAccountPath),
  });
}

const db = admin.firestore();
const courseId = 'ai-copywriting-course';

async function createModulesAndLessons() {
  console.log('üå± Creating modules and lessons for production course...');

  const modules = [
    {
      id: 'module-1',
      courseId,
      title: 'Alkoss hidat k√∂zted, √©s a vev≈ë k√∂z√∂tt - hogyan √©rintsd meg a vev≈ëdet',
      description: 'A kommunik√°ci√≥dban mindig te vagy a f≈ëh≈ës, nem a vev≈ë. Tal√°ld meg a k√∂z√∂s nevez≈ët a vev≈ëddel.',
      order: 0,
      totalLessons: 1,
      totalDuration: 240,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-1-1',
          title: 'Bevezet√©s - Hogyan ford√≠tsd meg a kommunik√°ci√≥t, hogy a vev≈ë azt mondja: ‚ÄûPont ≈ë kell nekem"',
          duration: 240,
          type: 'VIDEO',
          order: 0,
          isFreePreview: true
        }
      ]
    },
    {
      id: 'module-2',
      courseId,
      title: 'Hogyan √°ll√≠tsd be a kommunik√°ci√≥d, hogy csak azok hallj√°k, akik fizetni fognak',
      description: 'Pontos c√©lz√°s √©s c√©lcsoport meghat√°roz√°s AI eszk√∂z√∂kkel.',
      order: 1,
      totalLessons: 3,
      totalDuration: 720,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-2-1',
          title: 'Pontos c√©lz√°s, biztos tal√°lat - tal√°lj c√©lba a c√©lcsoportodn√°l',
          duration: 240,
          type: 'VIDEO',
          order: 0
        },
        {
          id: 'lesson-2-2',
          title: 'V√©lem√©nyek √©s trendek - hogyan der√≠tsd ki mire v√°gynak √©s mit≈ël f√©lnek a potenci√°lis v√°s√°rl√≥id?',
          duration: 240,
          type: 'VIDEO',
          order: 1
        },
        {
          id: 'lesson-2-3',
          title: '√ñsszefoglal√°s - a legfontosabb vev≈ëi insightok',
          duration: 240,
          type: 'VIDEO',
          order: 2
        }
      ]
    },
    {
      id: 'module-3',
      courseId,
      title: 'Ha nem ismered a vev≈ëdet, elvesz√≠ted a piacot t√©rk√©pezd fel azonnal!',
      description: 'Buyer persona k√©sz√≠t√©s √©s piackutat√°s AI eszk√∂z√∂kkel.',
      order: 2,
      totalLessons: 1,
      totalDuration: 540,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-3-1',
          title: 'Buyer persona - komplett vev≈ëi profil meghat√°roz√°sa 10 perc alatt ChatGPT-vel, val√≥s adatokb√≥l',
          duration: 540,
          type: 'VIDEO',
          order: 0
        }
      ]
    },
    {
      id: 'module-4',
      courseId,
      title: 'Hogyan √≠rd √∫gy az √ºzeneted, hogy el≈ësz√∂r √©rezze, azt√°n √©rtse meg ‚Äì √©s v√©g√ºl v√°s√°roljon',
      description: 'Pszichol√≥giai triggerek √©s √©rzelmi copywriting technik√°k.',
      order: 3,
      totalLessons: 5,
      totalDuration: 720,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-4-1',
          title: '√ârintsd meg a sz√≠v√©t, azt√°n a fej√©t - √≠gy nyersz √∂r√∂kre v√°s√°rl√≥t!',
          duration: 120,
          type: 'VIDEO',
          order: 0
        },
        {
          id: 'lesson-4-2',
          title: 'Haszn√°ld a ‚ÄûNa √©s?" technik√°t, hogy eljuss az el≈ëny√∂kh√∂z',
          duration: 60,
          type: 'VIDEO',
          order: 1
        },
        {
          id: 'lesson-4-3',
          title: 'Vev≈ëi elk√∂telezetts√©g f√°zisai',
          duration: 120,
          type: 'VIDEO',
          order: 2
        },
        {
          id: 'lesson-4-4',
          title: 'Mire f√≥kusz√°lj, hogy mindenki meg√©rtsen, √©s v√°s√°roljanak t≈ëled? Meghat√°rozzuk az MI seg√≠ts√©g√©vel 2 perc alatt',
          duration: 120,
          type: 'VIDEO',
          order: 3
        },
        {
          id: 'lesson-4-5',
          title: 'Egyedi √©rt√©k √©s √©rzelmi aj√°nlat kialak√≠t√°sa mesters√©ges intelligencia sablonb√≥l',
          duration: 300,
          type: 'VIDEO',
          order: 4
        }
      ]
    },
    {
      id: 'module-5',
      courseId,
      title: 'Hogyan sp√≥rolj √≥r√°kat az MI-val ‚Äì √©s √©rj be els≈ëk√©nt a piacra',
      description: 'Gyakorlati AI eszk√∂z√∂k √©s gener√°torok haszn√°lata.',
      order: 4,
      totalLessons: 7,
      totalDuration: 1140,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-5-1',
          title: 'Szem√©lyre szabott k√∂z√∂ss√©gi m√©dia poszt k√©sz√≠t√©se 3 perc alatt',
          duration: 180,
          type: 'VIDEO',
          order: 0
        },
        {
          id: 'lesson-5-2',
          title: 'A piac nem v√°r - √≠gy haszn√°ld az AI-t E-mail marketingre, hogy te legy√©l a gy≈ëztes',
          duration: 300,
          type: 'VIDEO',
          order: 1
        },
        {
          id: 'lesson-5-3',
          title: 'Szem√©lyre szabott Facebook hirdet√©s 2 perc alatt',
          duration: 120,
          type: 'VIDEO',
          order: 2
        },
        {
          id: 'lesson-5-4',
          title: 'Bulletpoint gener√°tor - bulletpointok k√©sz√≠t√©se term√©koldalra, landol√≥ oldalra, √©rt√©kes√≠t√©si oldalra 3 percben',
          duration: 180,
          type: 'VIDEO',
          order: 3
        },
        {
          id: 'lesson-5-5',
          title: 'Social media poszt gyors posztol√°shoz - 2 perc alatt',
          duration: 120,
          type: 'VIDEO',
          order: 4
        },
        {
          id: 'lesson-5-6',
          title: 'Landing oldal gener√°tor - √©rt√©kes√≠t√©si oldal k√©sz√≠t√©se 5 percben',
          duration: 180,
          type: 'VIDEO',
          order: 5
        },
        {
          id: 'lesson-5-7',
          title: 'Hirdet√©si hook k√©sz√≠t≈ë - sz√∂veg √©s k√©pgener√°tor facebook hirdet√©shez 3 perc alatt',
          duration: 60,
          type: 'VIDEO',
          order: 6
        }
      ]
    }
  ];

  // Create modules and lessons
  let totalModules = 0;
  let totalLessons = 0;

  for (const module of modules) {
    console.log(`\nüì¶ Creating module: ${module.title}`);

    // Create module document
    const moduleData = {
      courseId: module.courseId,
      title: module.title,
      description: module.description,
      order: module.order,
      totalLessons: module.totalLessons,
      totalDuration: module.totalDuration,
      status: module.status,
      createdAt: admin.firestore.FieldValue.serverTimestamp(),
      updatedAt: admin.firestore.FieldValue.serverTimestamp()
    };

    await db.collection('modules').doc(module.id).set(moduleData);
    totalModules++;
    console.log(`   ‚úÖ Module created: ${module.id}`);

    // Create lesson documents
    for (const lesson of module.lessons) {
      const lessonData = {
        courseId: module.courseId,
        moduleId: module.id,
        title: lesson.title,
        duration: lesson.duration,
        type: lesson.type,
        order: lesson.order,
        isFreePreview: lesson.isFreePreview || false,
        status: 'PUBLISHED',
        createdAt: admin.firestore.FieldValue.serverTimestamp(),
        updatedAt: admin.firestore.FieldValue.serverTimestamp()
      };

      await db.collection('lessons').doc(lesson.id).set(lessonData);
      totalLessons++;
      console.log(`      üìñ Lesson created: ${lesson.id}`);
    }
  }

  console.log(`\n‚úÖ All modules and lessons created successfully!`);
  console.log(`   Total Modules: ${totalModules}`);
  console.log(`   Total Lessons: ${totalLessons}`);

  process.exit(0);
}

createModulesAndLessons().catch((error) => {
  console.error('‚ùå Error:', error);
  process.exit(1);
});
