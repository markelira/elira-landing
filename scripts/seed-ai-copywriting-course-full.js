/**
 * Seed full AI Copywriting Course with all modules, lessons, video URLs, and PDF resources
 * For EMULATOR use only
 */

const admin = require('firebase-admin');

process.env.FIRESTORE_EMULATOR_HOST = '127.0.0.1:8080';

if (!admin.apps.length) {
  admin.initializeApp({ projectId: 'elira-landing-ce927' });
}

const db = admin.firestore();
const courseId = 'ai-copywriting-course';

// PDF Resources mapping
const pdfResources = {
  'blogpost': {
    id: 'pdf-blogpost',
    title: 'Blogposzt gener√°tor',
    description: 'AI prompt sablon blogposzt √≠r√°shoz',
    type: 'PDF',
    url: 'https://drive.google.com/file/d/1jw4_izUgnQHpnWDUswOCbKH0h6gkltcf/view?usp=sharing',
    isPublic: true
  },
  'bulletpoint': {
    id: 'pdf-bulletpoint',
    title: 'Bulletpoint gener√°tor',
    description: 'AI prompt sablon bulletpointok k√©sz√≠t√©s√©hez',
    type: 'PDF',
    url: 'https://drive.google.com/file/d/13adEI925qZLbmtnnWKUrhggkH5fhDVMC/view?usp=sharing',
    isPublic: true
  },
  'buyer-persona-generator': {
    id: 'pdf-buyer-persona-gen',
    title: 'Buyer persona gener√°tor',
    description: 'AI prompt sablon buyer persona k√©sz√≠t√©s√©hez',
    type: 'PDF',
    url: 'https://drive.google.com/file/d/1dfaiqQBV6hOOz_Iz1sANStfyNJvqGCMy/view?usp=sharing',
    isPublic: true
  },
  'buyer-persona': {
    id: 'pdf-buyer-persona',
    title: 'Buyer persona',
    description: 'Buyer persona dokumentum sablon',
    type: 'PDF',
    url: 'https://drive.google.com/file/d/1N8WaQQvskCiutXYPOD089leAhhMXijW3/view?usp=sharing',
    isPublic: true
  },
  'email-marketing': {
    id: 'pdf-email-marketing',
    title: 'Email marketing gener√°tor',
    description: 'AI prompt sablon email kamp√°nyokhoz',
    type: 'PDF',
    url: 'https://drive.google.com/file/d/1PnfgOCkNT29s6I4p5vJVAvKjaedrdffw/view?usp=sharing',
    isPublic: true
  },
  'facebook-ads': {
    id: 'pdf-facebook-ads',
    title: 'Facebook ads copy gener√°tor',
    description: 'AI prompt sablon Facebook hirdet√©sekhez',
    type: 'PDF',
    url: 'https://drive.google.com/file/d/1yCLa-UhSzdlxBsGzz3JkrNtXirPQ8jJV/view?usp=sharing',
    isPublic: true
  },
  'social-media': {
    id: 'pdf-social-media',
    title: 'K√∂z√∂ss√©gi m√©dia poszt gener√°tor',
    description: 'AI prompt sablon social media tartalmakhoz',
    type: 'PDF',
    url: 'https://drive.google.com/file/d/1M9eSYzQd7qkTy1KhBkLkBNwmV-x7XErE/view?usp=sharing',
    isPublic: true
  }
};

async function seedFullCourse() {
  console.log('üå± Seeding full AI Copywriting Course...\n');

  const modules = [
    {
      id: 'module-1',
      courseId,
      title: 'Alkoss hidat k√∂zted, √©s a vev≈ë k√∂z√∂tt - hogyan √©rintsd meg a vev≈ëdet',
      description: 'A kommunik√°ci√≥dban mindig te vagy a f≈ëh≈ës, nem a vev≈ë. Tal√°ld meg a k√∂z√∂s nevez≈ët a vev≈ëddel.',
      order: 0,
      totalLessons: 1,
      totalDuration: 240,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-1-1',
          title: 'Bevezet√©s - Hogyan ford√≠tsd meg a kommunik√°ci√≥t, hogy a vev≈ë azt mondja: ‚ÄûPont ≈ë kell nekem"',
          description: 'A kommunik√°ci√≥ megford√≠t√°s√°nak technik√°ja',
          duration: 240,
          type: 'VIDEO',
          order: 0,
          isFreePreview: true,
          content: {
            videoUrl: 'https://player.mux.com/02emHt502GnvD7gW8GjfkzNQmWGkwQR7Rcin02HAbYBDzs',
            videoProvider: 'mux'
          }
        }
      ]
    },
    {
      id: 'module-2',
      courseId,
      title: 'Hogyan √°ll√≠tsd be a kommunik√°ci√≥d, hogy csak azok hallj√°k, akik fizetni fognak',
      description: 'Pontos c√©lz√°s √©s c√©lcsoport meghat√°roz√°s AI eszk√∂z√∂kkel.',
      order: 1,
      totalLessons: 3,
      totalDuration: 720,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-2-1',
          title: 'Pontos c√©lz√°s, biztos tal√°lat - tal√°lj c√©lba a c√©lcsoportodn√°l',
          description: 'C√©lcsoport meghat√°roz√°s technik√°i',
          duration: 240,
          type: 'VIDEO',
          order: 0,
          content: {
            videoUrl: 'https://player.mux.com/9nUiGBHsu00erzpCSdEgfE2P27R4H2XqSMvZq02JOWzgM',
            videoProvider: 'mux'
          }
        },
        {
          id: 'lesson-2-2',
          title: 'V√©lem√©nyek √©s trendek - hogyan der√≠tsd ki mire v√°gynak √©s mit≈ël f√©lnek a potenci√°lis v√°s√°rl√≥id?',
          description: 'Piackutat√°s √©s trendanal√≠zis',
          duration: 240,
          type: 'VIDEO',
          order: 1,
          content: {
            videoUrl: 'https://player.mux.com/Q5ai00WXITXwlLsiODwO2DGbGqXp5YnlIk7VPbUKzlRU',
            videoProvider: 'mux'
          }
        },
        {
          id: 'lesson-2-3',
          title: '√ñsszefoglal√°s - a legfontosabb vev≈ëi insightok',
          description: 'Vev≈ëi meg√©rt√©s √∂sszegz√©se',
          duration: 240,
          type: 'VIDEO',
          order: 2,
          content: {
            videoUrl: 'https://player.mux.com/P004bsdgUZWZUkP00V2XHEz02jLciWlHW36UxRKjr5VSjs',
            videoProvider: 'mux'
          }
        }
      ]
    },
    {
      id: 'module-3',
      courseId,
      title: 'Ha nem ismered a vev≈ëdet, elvesz√≠ted a piacot t√©rk√©pezd fel azonnal!',
      description: 'Buyer persona k√©sz√≠t√©s √©s piackutat√°s AI eszk√∂z√∂kkel.',
      order: 2,
      totalLessons: 1,
      totalDuration: 540,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-3-1',
          title: 'Buyer persona - komplett vev≈ëi profil meghat√°roz√°sa 10 perc alatt ChatGPT-vel, val√≥s adatokb√≥l',
          description: 'Buyer persona automatikus gener√°l√°sa',
          duration: 540,
          type: 'VIDEO',
          order: 0,
          content: {
            videoUrl: 'https://player.mux.com/Dj8qeORP01O2itqZzfqXnomhIB7c01HMn5Zraaltf6AAk',
            videoProvider: 'mux'
          },
          resources: [
            pdfResources['buyer-persona-generator'],
            pdfResources['buyer-persona']
          ]
        }
      ]
    },
    {
      id: 'module-4',
      courseId,
      title: 'Hogyan √≠rd √∫gy az √ºzeneted, hogy el≈ësz√∂r √©rezze, azt√°n √©rtse meg ‚Äì √©s v√©g√ºl v√°s√°roljon',
      description: 'Pszichol√≥giai triggerek √©s √©rzelmi copywriting technik√°k.',
      order: 3,
      totalLessons: 5,
      totalDuration: 720,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-4-1',
          title: '√ârintsd meg a sz√≠v√©t, azt√°n a fej√©t - √≠gy nyersz √∂r√∂kre v√°s√°rl√≥t!',
          description: '√ârzelmi kapcsolat kialak√≠t√°sa',
          duration: 120,
          type: 'VIDEO',
          order: 0,
          content: {
            videoUrl: 'https://player.mux.com/4nerha00pbGODs00T2Z027GY4xKZBDhmVYrkxyiSAq01T01A',
            videoProvider: 'mux'
          }
        },
        {
          id: 'lesson-4-2',
          title: 'Haszn√°ld a ‚ÄûNa √©s?" technik√°t, hogy eljuss az el≈ëny√∂kh√∂z',
          description: 'El≈ëny√∂k kommunik√°ci√≥ja',
          duration: 60,
          type: 'VIDEO',
          order: 1,
          content: {
            videoUrl: 'https://player.mux.com/00N600Lzl6rQQxVBeOj02yUcHwTAer00W68fceHwxrdb00fM',
            videoProvider: 'mux'
          }
        },
        {
          id: 'lesson-4-3',
          title: 'Vev≈ëi elk√∂telezetts√©g f√°zisai',
          description: 'V√°s√°rl√≥i √∫t meg√©rt√©se',
          duration: 120,
          type: 'VIDEO',
          order: 2,
          content: {
            videoUrl: 'https://player.mux.com/VsfzsYtdqZmvtvZgkW00NHZh7dIEEK02KlRpChf6eHyS4',
            videoProvider: 'mux'
          }
        },
        {
          id: 'lesson-4-4',
          title: 'Mire f√≥kusz√°lj, hogy mindenki meg√©rtsen, √©s v√°s√°roljanak t≈ëled? Meghat√°rozzuk az MI seg√≠ts√©g√©vel 2 perc alatt',
          description: '√úzenet f√≥kusz√°l√°s AI-val',
          duration: 120,
          type: 'VIDEO',
          order: 3,
          content: {
            videoUrl: 'https://player.mux.com/OZzSCxaqpHJ59ZhhBfCSu02kDoFwvZJ3ayDWne4FjlDE',
            videoProvider: 'mux'
          }
        },
        {
          id: 'lesson-4-5',
          title: 'Egyedi √©rt√©k √©s √©rzelmi aj√°nlat kialak√≠t√°sa mesters√©ges intelligencia sablonb√≥l',
          description: '√ârt√©kaj√°nlat k√©sz√≠t√©s',
          duration: 300,
          type: 'VIDEO',
          order: 4,
          content: {
            videoUrl: 'https://player.mux.com/8ysyo01m602YIhDH201dU8201I00TixT5l3derL3IBO1kv6I',
            videoProvider: 'mux'
          }
        }
      ]
    },
    {
      id: 'module-5',
      courseId,
      title: 'Hogyan sp√≥rolj √≥r√°kat az MI-val ‚Äì √©s √©rj be els≈ëk√©nt a piacra',
      description: 'Gyakorlati AI eszk√∂z√∂k √©s gener√°torok haszn√°lata.',
      order: 4,
      totalLessons: 7,
      totalDuration: 1140,
      status: 'PUBLISHED',
      lessons: [
        {
          id: 'lesson-5-1',
          title: 'Szem√©lyre szabott k√∂z√∂ss√©gi m√©dia poszt k√©sz√≠t√©se 3 perc alatt',
          description: 'Social media automatiz√°ci√≥',
          duration: 180,
          type: 'VIDEO',
          order: 0,
          content: {
            videoUrl: 'https://player.mux.com/sRIiDANomGGc01tVBzz5WaaOGL5MkBaupZuQ01T4AoiEM',
            videoProvider: 'mux'
          },
          resources: [pdfResources['social-media']]
        },
        {
          id: 'lesson-5-2',
          title: 'A piac nem v√°r - √≠gy haszn√°ld az AI-t E-mail marketingre, hogy te legy√©l a gy≈ëztes',
          description: 'Email marketing AI technik√°k',
          duration: 300,
          type: 'VIDEO',
          order: 1,
          content: {
            videoUrl: 'https://player.mux.com/h95zvWKWKweg51qHUu7gSegED900LToW2In9wDjiW4GQ',
            videoProvider: 'mux'
          },
          resources: [pdfResources['email-marketing']]
        },
        {
          id: 'lesson-5-3',
          title: 'Szem√©lyre szabott Facebook hirdet√©s 2 perc alatt',
          description: 'Facebook Ads optimaliz√°ci√≥',
          duration: 120,
          type: 'VIDEO',
          order: 2,
          content: {
            videoUrl: 'https://player.mux.com/RvjZzGc8Y2dsaOx57RlTHF1Y7OoWY02vbNVT1OvtXwzo',
            videoProvider: 'mux'
          },
          resources: [pdfResources['facebook-ads']]
        },
        {
          id: 'lesson-5-4',
          title: 'Bulletpoint gener√°tor - bulletpointok k√©sz√≠t√©se term√©koldalra, landol√≥ oldalra, √©rt√©kes√≠t√©si oldalra 3 percben',
          description: 'Bulletpoint automatiz√°ci√≥',
          duration: 180,
          type: 'VIDEO',
          order: 3,
          content: {
            videoUrl: 'https://player.mux.com/BfpIGZ8xZ1RcrqKD01Qzk2TmSB729QB00QORhrq4HT8Qw',
            videoProvider: 'mux'
          },
          resources: [pdfResources['bulletpoint']]
        },
        {
          id: 'lesson-5-5',
          title: 'Blogposzt gener√°tor - blog posztok, amivel a Google-ben az els≈ë oldalra ker√ºlhetsz',
          description: 'SEO blog content gener√°l√°s',
          duration: 120,
          type: 'VIDEO',
          order: 4,
          content: {
            videoUrl: 'https://player.mux.com/OBtxOrngXliDZRbg00vemAUlrWGOXgayLirZHyYLqIKA',
            videoProvider: 'mux'
          },
          resources: [pdfResources['blogpost']]
        },
        {
          id: 'lesson-5-6',
          title: 'Hogyan tedd emberiv√© a sz√∂veged, hogy ne ker√ºlj√∂n a h√≠rleveled spam-be',
          description: 'Humaniz√°lt tartalom k√©sz√≠t√©se',
          duration: 180,
          type: 'VIDEO',
          order: 5,
          content: {
            videoUrl: 'https://player.mux.com/zenvxOXRH8D31379FAyPYU3P1nnZnBjqdK22TsdywlQ',
            videoProvider: 'mux'
          }
        },
        {
          id: 'lesson-5-7',
          title: 'Befejez√©s, k√∂sz√∂net!',
          description: 'Kurzus lez√°r√°sa',
          duration: 60,
          type: 'VIDEO',
          order: 6,
          content: {
            videoUrl: 'https://player.mux.com/01qex0100vtX01evBwtGH8TRl182v02ifI9vmLBg2SAiRD1s',
            videoProvider: 'mux'
          }
        }
      ]
    }
  ];

  // Create modules and lessons
  let totalModules = 0;
  let totalLessons = 0;

  for (const module of modules) {
    console.log(`\nüì¶ Creating module: ${module.title}`);

    // Create module document
    const moduleData = {
      courseId: module.courseId,
      title: module.title,
      description: module.description,
      order: module.order,
      totalLessons: module.totalLessons,
      totalDuration: module.totalDuration,
      status: module.status,
      createdAt: admin.firestore.FieldValue.serverTimestamp(),
      updatedAt: admin.firestore.FieldValue.serverTimestamp()
    };

    await db.collection('modules').doc(module.id).set(moduleData);
    totalModules++;
    console.log(`   ‚úÖ Module created: ${module.id}`);

    // Create lesson documents
    for (const lesson of module.lessons) {
      const lessonData = {
        courseId: module.courseId,
        moduleId: module.id,
        title: lesson.title,
        description: lesson.description || '',
        duration: lesson.duration,
        type: lesson.type,
        order: lesson.order,
        content: lesson.content,
        resources: lesson.resources || [],
        isFreePreview: lesson.isFreePreview || false,
        status: 'PUBLISHED',
        createdAt: admin.firestore.FieldValue.serverTimestamp(),
        updatedAt: admin.firestore.FieldValue.serverTimestamp()
      };

      await db.collection('lessons').doc(lesson.id).set(lessonData);
      totalLessons++;
      const resourceInfo = lesson.resources ? ` + ${lesson.resources.length} PDF(s)` : '';
      console.log(`      üìñ Lesson created: ${lesson.id} (with video${resourceInfo})`);
    }
  }

  // Update course with correct stats
  await db.collection('courses').doc(courseId).update({
    totalModules,
    totalLessons,
    totalDuration: modules.reduce((sum, m) => sum + m.totalDuration, 0),
    updatedAt: admin.firestore.FieldValue.serverTimestamp()
  });

  console.log(`\n‚úÖ Full AI Copywriting Course seeded successfully!`);
  console.log(`   Total Modules: ${totalModules}`);
  console.log(`   Total Lessons: ${totalLessons}`);
  console.log(`   Course ID: ${courseId}`);
  console.log(`\nüîó Access at: http://localhost:3000/courses/${courseId}/learn\n`);

  process.exit(0);
}

seedFullCourse().catch((error) => {
  console.error('‚ùå Error:', error);
  process.exit(1);
});
