const admin = require('firebase-admin');

// Initialize Firebase Admin for production
const serviceAccount = {
  projectId: 'elira-landing-ce927',
  clientEmail: 'firebase-adminsdk-fbsvc@elira-landing-ce927.iam.gserviceaccount.com',
  privateKey: process.env.FIREBASE_PRIVATE_KEY?.replace(/\\n/g, '\n')
};

if (!admin.apps.length) {
  admin.initializeApp({
    credential: admin.credential.cert(serviceAccount),
    projectId: 'elira-landing-ce927',
    storageBucket: 'elira-landing-ce927.firebasestorage.app'
  });
}

const db = admin.firestore();

async function createCourseProduction() {
  try {
    console.log('üöÄ Creating ai-copywriting-course for production...');
    
    const courseId = 'ai-copywriting-course';
    
    // Complete course data extracted from homepage components
    const courseData = {
      // Basic info
      title: 'Olvass a vev≈ëid gondolataiban',
      slug: 'ai-copywriting-course',
      description: 'AI-alap√∫ copywriting √©s marketingkutat√°s kurzus. K√©pzeld el, hogy percek alatt k√©sz√≠tesz buyer person√°t, pontosan felt√©rk√©pezed a piacodat, √©s az MI-vel olyan sz√∂vegeket √≠rsz, amelyek nem csak a figyelmet ragadj√°k meg, hanem profitot is termelnek.',
      shortDescription: 'Tanulj meg hat√©kony sz√∂vegeket √≠rni AI eszk√∂z√∂kkel √©s ChatGPT-vel.',
      status: 'PUBLISHED',
      visibility: 'PUBLIC',
      
      // Instructor - from ZoliIntroduction component
      instructorId: 'zoltan-somosi',
      instructorName: 'Somosi Zolt√°n',
      instructorEmail: 'zoltan@elira.hu',
      instructorBio: 'E-mail √©s trigger marketing specialista a Heureka Groupn√°l, √©s doktorandusz a Miskolci Egyetemen, ahol a mesters√©ges intelligencia √©s az online marketing hat√©konys√°ga a kutat√°si ter√ºletem.',
      instructorPhotoUrl: '/IMG_5730.JPG',
      instructorTitle: 'Marketing Specialista & Doktorandusz',
      instructorInstitution: 'Miskolci Egyetem & Heureka Group',
      instructorLinkedIn: 'https://linkedin.com/in/zolt√°n-somosi-299605226',
      
      // Category
      categoryId: 'ai-marketing',
      categoryName: 'AI Marketing',
      language: 'hu',
      difficulty: 'INTERMEDIATE',
      
      // Media
      thumbnailUrl: '/Cover_Olvass_a_vev≈ëid_gondolataiban-min.png',
      previewVideoUrl: 'https://player.mux.com/tTZjKcQAhn0233X1jBoj4UARa2nEKnEDRarPGZNUJ2Gg',
      
      // Pricing - from PricingSection and Stripe configuration
      price: 9990,
      currency: 'HUF',
      isFree: false,
      stripePriceId: 'price_1S0MvyHhqyKpFIBMQdiSPodM',
      stripeProductId: 'prod_SwFQ50r0KCrxss',
      
      // Learning objectives - from CourseDetailsSection highlights
      objectives: [
        'Buyer persona kidolgoz√°sa 10 perc alatt MI seg√≠ts√©g√©vel',
        'Versenyt√°rs anal√≠zis automatiz√°l√°sa AI eszk√∂z√∂kkel',
        'Pszichol√≥giai triggerek alkalmaz√°sa a copywritingban',
        'Email marketing automatiz√°ci√≥ k√©sz√≠t√©se',
        'Facebook Ads copy gener√°tor haszn√°lata',
        'Social media tartalom tervez√©s AI-val'
      ],
      
      prerequisites: [
        'Alapvet≈ë sz√°m√≠t√≥g√©pes ismeretek',
        'Magyar nyelv magas szint≈± ismerete', 
        'Nyitotts√°g az √∫j technol√≥gi√°k ir√°nt',
        'V√°llalkoz√≥i vagy marketinges h√°tt√©r el≈ëny'
      ],
      
      targetAudience: [
        'V√°llalkoz√≥k, akik megunta, hogy minden fill√©rt √ºgyn√∂ks√©gekre k√∂lt',
        'Marketingesek, akiket a f≈ën√∂k folyamatosan szor√≠t jobb sz√°mok√©rt',
        'Akik tiszt√°ban vannak vele, hogy lemaradnak az AI forradalomr√≥l'
      ],
      
      // Course features - from homepage components
      features: [
        'Buyer persona k√©sz√≠t√©se 5 perc alatt MI seg√≠ts√©g√©vel',
        'F√°jdalompontok felt√°r√°sa automatiz√°lt m√≥dszerekkel',
        'Profitn√∂vel≈ë sz√∂veg√≠r√°s AI-val',
        'MI-sablonok k√©sz√≠t√©se √©s haszn√°lata',
        'Konkr√©t p√©ld√°k √©s gyakorlatok',
        '7 let√∂lthet≈ë PDF sablon',
        'Azonnali hozz√°f√©r√©s',
        '30 napos p√©nzvisszafizet√©si garancia'
      ],
      
      // Settings
      certificateEnabled: true,
      
      // Stats - from homepage
      enrollmentCount: 312,
      completionCount: 200,
      averageRating: 4.9,
      totalReviews: 89,
      
      // Content stats - from CourseDetailsSection
      totalModules: 5,
      totalLessons: 17,
      totalDuration: 3360, // 56 minutes in seconds
      totalVideos: 17,
      totalPDFs: 7,
      
      // Timestamps
      createdAt: admin.firestore.FieldValue.serverTimestamp(),
      updatedAt: admin.firestore.FieldValue.serverTimestamp(),
      publishedAt: admin.firestore.FieldValue.serverTimestamp(),
      
      // Additional metadata
      isPlus: true,
      isFeatured: true,
      tags: ['AI', 'Copywriting', 'Marketing', 'ChatGPT', 'Email Marketing', 'Facebook Ads'],
      seoKeywords: ['AI copywriting', 'mesters√©ges intelligencia marketing', 'ChatGPT copywriting', 'buyer persona', 'email marketing'],
      
      // Course value proposition
      courseValue: {
        totalComponentValue: 32000, // From PricingSection calculation
        actualPrice: 9990,
        savings: 22010,
        valueComponents: [
          { text: '5 modul, 17 vide√≥ (56 perc)', value: 8000 },
          { text: '7 AI gener√°tor PDF', value: 5000 },
          { text: 'Gyakorlati AI prompt sablonok', value: 3000 },
          { text: 'Doktorandusz oktat√≥ szak√©rtelem', value: 12000 },
          { text: 'Magyar piacra szabott tartalom', value: 4000 }
        ]
      }
    };
    
    // Create the course document
    await db.collection('courses').doc(courseId).set(courseData, { merge: true });
    console.log('‚úÖ Course created/updated:', courseId);
    
    console.log('\nüéâ Course creation complete!');
    console.log(`üìç Course ID: ${courseId}`);
    console.log(`üí∞ Price: ${courseData.price} ${courseData.currency}`);
    console.log(`üí≥ Stripe Price ID: ${courseData.stripePriceId}`);
    console.log(`üîó Product ID: ${courseData.stripeProductId}`);
    
  } catch (error) {
    console.error('‚ùå Error creating course:', error);
  } finally {
    process.exit(0);
  }
}

createCourseProduction();